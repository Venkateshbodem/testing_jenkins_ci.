
/*
 * Copyright 2013 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

apply plugin: "java"

// START SNIPPET apply-plugin
apply plugin: "jacoco"
// END SNIPPET apply-plugin

// START SNIPPET jacoco-configuration
jacoco {
    toolVersion = "0.7.1.201405082137"
    reportsDir = file("$buildDir/customJacocoReportDir")
}
// END SNIPPET jacoco-configuration

// START SNIPPET jacoco-thresholds
jacoco {
    // Minimum code coverage of 50% across all files and coverage types.
    threshold 0.5

    // Minimum 'branch' coverage of 30% across all files.
    // Available coverage types: BRANCH, CLASS, COMPLEXITY, INSTRUCTION, LINE, METHOD.
    threshold 0.3, BRANCH

    // Minimum 'line' coverage of 10% for any file (in any directory) whose name matches the given regular expression.
    threshold 0.1, LINE, ~"P.*\\.java"

    // Minimum 'line' coverage of 10% for files named "Person.java" (case-sensitive, in any directory).
    // (Note: This syntax uses exact string match against the file name while the regex syntax requires escaping.)
    threshold 0.1, LINE, "Person.java"
}
// END SNIPPET jacoco-thresholds

repositories {
    mavenCentral()
}

dependencies {
    testCompile "junit:junit:4.+"
}

// START SNIPPET testtask-configuration
test {
    jacoco {
        append = false
        destinationFile = file("$buildDir/jacoco/jacocoTest.exec")
        classDumpFile = file("$buildDir/jacoco/classpathdumps")
    }
}
// END SNIPPET testtask-configuration


// START SNIPPET report-configuration
jacocoTestReport {
    reports {
        xml.enabled false
        csv.enabled false
        html.destination "${buildDir}/jacocoHtml"
    }
}
// END SNIPPET report-configuration
